data_2006 <- read.csv("../../data/MERGED2005_06_PP.csv")

for (i in 1:ncol(data_2006)) {
  if (is.factor(data_2006[,i]) == TRUE) {
    data_2006[,i] <- as.numeric(levels(data_2006[,i]))[data_2006[,i]]
  }
}

##### remove columns with less than 25% of data missing

data_2006 <- data_2006[, colSums(is.na(data_2006)) <= .25 * nrow(data_2006)]

##### scaling and mean centering data

scaled_data_2006 <- scale(data_2006, center = TRUE, scale = TRUE)
scaled_data_2006 <- cbind( data_2006[, c(1,2)], scaled_data_2006[,c(-1,-2)])

for(i in 1:ncol(scaled_data_2006)){
  scaled_data_2006[is.na(scaled_data_2006[,i]), i] <- median(scaled_data_2006[,i], na.rm = TRUE)
}

scaled_data_2006 <- scaled_data_2006[, colSums(is.na(scaled_data_2006)) <= .5 * nrow(scaled_data_2006)]

write.csv(scaled_data_2006, file = "../../data/scaled_data_2006.csv")
